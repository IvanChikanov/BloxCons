import {HTMLFather as HTML} from "../system_js/HTMLFather.js";
import {CellFather as Cell} from "../system_js/Cell.min.js"
class MainGridFather
{
    static allGrids = [];
    cellArray = [];
    id;
    number;
    gridElem;
    outsideRows;
    navigate;
    static activePage = 0;
    constructor(loadData)
    {
        this.id = loadData.id;
        this.number = loadData.number;
        this.outsideRows = loadData.cellArray.length;
        this.#createGrid();
        MainGridFather.allGrids.push(this);
        this.number = MainGridFather.allGrids.length;
        this.createCell(loadData);
        if(MainGridFather.allGrids.length > 1)
        {
            this.setActive();
        }   
    }
    createCell(data)
    {
        for(let i = 1; i <= data.cellArray.length; i++)
        {
            this.cellArray.push(new Cell(this, data.cellArray[i-1]));
        }
    }
    #createGrid()
    {
        this.gridElem = HTML.createAndAppend("DIV");
        HTML.addStyles(["mainGrid", "absolute", "gapFivePix", "hCenter" , "bottomMargin10px"], [this.gridElem]);
        this.gridElem.style.gridTemplateRows = `repeat(${this.outsideRows}, auto)`;
    }
    setActive()
    {
        if(MainGridFather.allGrids[MainGridFather.activePage].navigate)
        {
            MainGridFather.allGrids[MainGridFather.activePage].gridElem.removeChild(MainGridFather.allGrids[MainGridFather.activePage].navigate);
            MainGridFather.allGrids[MainGridFather.activePage].navigate = null;
        }
        this.gridElem.classList.remove("hide");
        if(MainGridFather.activePage != MainGridFather.allGrids.indexOf(this))
        {
            MainGridFather.allGrids[MainGridFather.activePage].gridElem.classList.toggle("hide");
        }
        this.appendPageControllCell();
        MainGridFather.activePage = MainGridFather.allGrids.indexOf(this);
    }
    appendPageControllCell()
    {
        if(MainGridFather.allGrids.indexOf(this) == 0)
        {
            if(MainGridFather.allGrids.length > 1)
            {
                this.navigate = this.nextPage();
                this.gridElem.appendChild(this.navigate);
            }
        }
        else if(MainGridFather.allGrids.indexOf(this) == MainGridFather.allGrids.length - 1)
        {
            if(MainGridFather.allGrids.length > 1)
            {
                this.navigate = this.prevPage();
                this.gridElem.appendChild(this.navigate);
            }
        }
        else
        {
            let d = HTML.create("DIV");
            d.appendChild(this.prevPage());
            d.appendChild(this.nextPage());
            HTML.addStyles(["justifySelfCenter", "alignSelfCenter"], [d]);
            this.navigate = d;
            this.gridElem.appendChild(this.navigate);
        }
    }
    nextPage()
    {
        let nBut = HTML.create("BUTTON");
        HTML.addStyles(["justifySelfCenter", "alignSelfCenter", "margin5pix"], [nBut]);
        nBut.innerText = "Вперед";
        nBut.onclick = ()=>{
            MainGridFather.allGrids[MainGridFather.allGrids.indexOf(this) + 1].setActive();
        };
        return nBut;
    }
    prevPage()
    {
        let pBut = HTML.create("BUTTON");
        HTML.addStyles(["justifySelfCenter", "alignSelfCenter", "margin5pix"], [pBut]);
        pBut.innerText = "Назад";
        pBut.onclick = ()=>{
            MainGridFather.allGrids[MainGridFather.allGrids.indexOf(this) - 1].setActive();
        };
        return pBut;
    }
}
export {MainGridFather};